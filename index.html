<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" type="image/png" href="favicon.png">

        <title>Rising Tides | Find The Dip</title>
        
        <!--bootstrap-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />

        <!--google fonts-->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">

        <!--custom style-->
        <link href="./style.css" rel="stylesheet" />

        <!--scripts-->
        <script src="https://cdn.jsdelivr.net/npm/lightweight-charts@4.2.2/dist/lightweight-charts.standalone.production.min.js"></script>
    </head>

    <body class="d-flex flex-column h-100">
        <div class="container-fluid text-center">
            <nav class="row">
                <div class="order-1 col-6 col-md-4 ps-3 ps-md-5 text-start">
                    <div class="logo-wrap">
                        <img class="logo" src="logo.png" alt="logo for Rising Tides" />
                        <div class="surfs-up-brah-logo"></div>
                    </div>
                </div>
                <div class="order-3 order-md-2 col-12 col-md-4">
                    <a href="#">Home</a>
                    <span> / </span>
                    <a href="#">Top Picks</a>
                    <span> / </span>
                    <a href="#">Donate!</a>
                </div>
                <div class="order-2 order-md-3 col-6 col-md-4 pe-3 pe-md-5 text-end">
                    <a href="#" class="text-decoration-none">
                        <svg width="20" viewbox="0 0 24 24" aria-hidden="true" class="r-4qtqp9 r-yyyyoo r-dnmrzs r-bnwqim r-lrvibr r-m6rgpd r-lrsllp r-1nao33i r-16y2uox r-8kz0gk"><g><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" style="fill:none;stroke:white"></path></g></svg>
                    </a>
                    <span> / </span>
                    <a href="#" class="text-decoration-none">
                        <svg width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="m8 16c4.418278 0 8-3.581722 8-8s-3.581722-8-8-8-8 3.581722-8 8 3.581722 8 8 8zm-1.33048041-6.37283475 3.70945371-3.34749858c.1628067-.14449267-.0355533-.21495334-.25168-.08389334l-4.57819997 2.88833334-1.97753333-.61722c-.42706-.13076-.43012667-.42422.09588-.6352l7.706-2.9714c.3519533-.15978667.6916533.08453333.5572933.62321333l-1.3123333 6.1842c-.09164.43946-.3571667.54456-.72506667.3415667l-1.99909645-1.4769586-.96090355.9343586c-.11163333.1085333-.2.2-.4.2l.13613334-2.03953337z" fill="#fff"></path></svg>
                        <!--<svg width="20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Livello_1" x="0px" y="0px" viewBox="0 0 240.1 240.1" enable-background="new 0 0 240.1 240.1" xml:space="preserve">
                            <g id="Artboard">
                                
                                    <linearGradient id="Oval_1_" gradientUnits="userSpaceOnUse" x1="-838.041" y1="660.581" x2="-838.041" y2="660.3427" gradientTransform="matrix(1000 0 0 -1000 838161 660581)">
                                    <stop offset="0" style="stop-color:#ff0000"></stop>
                                    <stop offset="1" style="stop-color:#00ff00"></stop>
                                </linearGradient>
                                <circle xmlns="http://www.w3.org/2000/svg" id="Oval" fill-rule="evenodd" stroke="white" stroke-width="10" clip-rule="evenodd" fill="none" cx="120.1" cy="120.1" r="120.1"></circle>
                                <path id="Path-3" fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M54.3,118.8c35-15.2,58.3-25.3,70-30.2   c33.3-13.9,40.3-16.3,44.8-16.4c1,0,3.2,0.2,4.7,1.4c1.2,1,1.5,2.3,1.7,3.3s0.4,3.1,0.2,4.7c-1.8,19-9.6,65.1-13.6,86.3   c-1.7,9-5,12-8.2,12.3c-7,0.6-12.3-4.6-19-9c-10.6-6.9-16.5-11.2-26.8-18c-11.9-7.8-4.2-12.1,2.6-19.1c1.8-1.8,32.5-29.8,33.1-32.3   c0.1-0.3,0.1-1.5-0.6-2.1c-0.7-0.6-1.7-0.4-2.5-0.2c-1.1,0.2-17.9,11.4-50.6,33.5c-4.8,3.3-9.1,4.9-13,4.8   c-4.3-0.1-12.5-2.4-18.7-4.4c-7.5-2.4-13.5-3.7-13-7.9C45.7,123.3,48.7,121.1,54.3,118.8z"></path>
                            </g>
                        </svg>-->
                    </a>
                </div>
            </nav>
        </div>

        <div class="container text-center pb-5">
            <div class="row mt-5">
                <div class="col-12">
                    <hgroup>
                        <h1>Rising Tides</h1>
                        <p class="d-none">Find The Dip</p>
                    </hgroup>
                </div>
            </div>

            <div class="row d-flex justify-content-center mt-5 d-none">
                <div class="col-8">
                    <div class="moving-waves-wrap mb-2">
                        <img class="moving-wave wave-a" src="wave.svg" />
                        <img class="moving-wave wave-b" src="wave.svg" />
                        <img class="moving-wave wave-c" src="wave.svg" />
                    </div>
                </div>
            </div>
            
            <div class="row d-flex justify-content-center mt-5">
                <div class="col-12 col-md-10">
                    <div class="container">
                        <div class="row d-flex justify-content-center">
                            <div class="col-12 col-md-8">
                                <p class="lead">
                                    Stop buying the peak, buy the dip.
                                </p>
                                <p>
                                    This tool searches all pairs available on Binance and finds those currently trading below a given moving average.
                                    <br /><span class="font-smaller">(more exchanges to be added soon)</span>
                                </p>
                            </div>
                        </div>
                        <div class="row mt-2 pt-4 steps-area">
                            <div class="col-12 col-md-4">
                                <span class="steps-number">&#9312;</span>
                                <p>Choose your settings</p>
                            </div>
                            <div class="col-12 col-md-4">
                                <span class="steps-number">&#9313;</span>
                                <p>Run the search</p>
                            </div>
                            <div class="col-12 col-md-4">
                                <span class="steps-number">&#9314;</span>
                                <p>Sort by price movement characteristics.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row d-flex justify-content-center mt-5">
                <div class="col-10">
                    <div class="form-wrap">
                        <h3 class="form-heading">Controls</h3>
                        <form id="mainControlsForm" onsubmit="handleMainControlFormValidation(); return false;" class="row g-3 needs-validation" novalidate>
                            <div class="col-md-4">
                                <label for="candleIntervalSelector" class="form-label">Candle interval</label>
                                <select id="candleIntervalSelector" class="form-select p-3">
                                  <option value="1m">1m</option>
                                  <option value="5m">5m</option>
                                  <option value="15m">15m</option>
                                  <option value="30m">30m</option>
                                  <option value="1h">1h</option>
                                  <option value="4h" selected>4h</option>
                                  <option value="1d">1d</option>
                                  <option value="1w">1w</option>
                                  <option value="1M">1M</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="movingAveragePeriod" class="form-label">Moving average period</label>
                                <input type="text" class="form-control p-3" id="movingAveragePeriod" value="50" required>
                            </div>
                            <div class="col-md-4">
                                <label for="timeframeSelector" class="form-label">How many candles? (1000 max)</label>
                                <input type="text" class="form-control p-3" id="timeframeSelector" value="1000" required>
                            </div>
                            <div id="mainControlsFormErrorArea" class="invalid-feedback mt-4"></div>
                            <div class="col-12">
                                <button type="submit" class="btn btn-lg btn-primary rt-button-primary">Search</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <div class="row d-flex justify-content-center mt-5 d-none">
                <div class="col-8">
                    <div class="form-wrap">
                        <h3 class="form-heading">Additional controls</h3>
                        <form id="additionalControlsForm" onsubmit="handleMainControlFormValidation(); return false;" class="row g-3 needs-validation" novalidate>
                            <div class="col-md-4">
                                <label for="showOnly" class="form-label">Interval</label>
                                <select id="showOnly" class="form-select p-3">
                                  <option value="dippers">dippers</option>
                                  <option value="all">all</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="timeTravelOffestSelector" class="form-label">Moving average period</label>
                                <input type="text" class="form-control p-3" id="timeTravelOffestSelector" value="0" required>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div id="loadingSpinner" class="row d-flex justify-content-center mt-5 d-none">
                <div class="col-4">
                    <div class="slosh-box-spinner">
                        <div class="sbs-bars" id="sbs1"></div>
                        <div class="sbs-bars" id="sbs2"></div>
                        <div class="sbs-bars" id="sbs3"></div>
                        <div class="sbs-bars" id="sbs4"></div>
                    </div>
                </div>
            </div>

            <div id="chartsAreaWrap" class="row mt-5 d-none">
                <div class="col-12">
                    <form class="row d-flex justify-content-center sort-area" onchange="resetShowCount(); drawCharts(); return false;">
                        <div class="col-12">
                            <label for="theSort">sort</label>
                            <select id="theSort" class="p-1">
                                <option value="">-</option>
                                <option value="sineWaveRating">The closest to a sine wave</option>
                                <option value="candlesStartingAboveRatio">Ratio of candles starting above to below</option>
                                <option value="candlesStartingBelowRatio">Ratio of candles starting below to above</option>
                                <option value="candlesStartingMediocrityScore">Most even ratio of candles starting above to below</option>
                                <option value="cumulativePercentAboveRatio">Ratio of percent gained above the line to lost below</option>
                                <option value="cumulativePercentBelowRatio">Ratio of percent lost below the line to gained above</option>
                                <option value="cumulativePercentMediocrityScore">Most even ratio of percent changed above or below</option>
                                <option value="flattestMa">Least volatile MA - (changing by the least %)</option>
                                <option value="craziestMa">Most volatile MA - (changing by the most %)</option>
                                <option value="spikeScoreAbove">Most spikey, the most peaks above the MA in the shortest time</option>
                                <option value="crossPerCandle">Frequency the MA line is crossed</option>
                                <option value="giniLow">even price heatmap</option>
                                <option value="giniHigh">uneven price heatmap</option>
                            </select>
                        </div>
                        <div class="col-6 d-none">
                            <label for="theSortTwo">sort</label>
                            <select id="theSortTwo" class="p-1">
                                <option value="">-</option>
                                <option value="candlesStartingAboveRatio">candlesStartingAboveRatio</option>
                                <option value="candlesStartingBelowRatio">candlesStartingBelowRatio</option>
                                <option value="candlesStartingMediocrityScore">candlesStartingMediocrityScore</option>
                                <option value="cumulativePercentMediocrityScore">cumulativePercentMediocrityScore</option>
                                <option value="cumulativePercentAboveRatio">cumulativePercentAboveRatio</option>
                                <option value="cumulativePercentBelowRatio">cumulativePercentBelowRatio</option>
                                <option value="flattestMa">flattestMa (changing by the least %)</option>
                                <option value="craziestMa">craziestMa (changing by the most %)</option>
                                <option value="spikeScoreAbove">spikeScore above</option>
                                <option value="crossPerCandle">frequency the MA line is crossed</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="col-12">
                    <div id="chartsArea"></div>
                </div>
            </div>

            <div class="row mt-5 d-none">
                <div class="col-12">
                    <h2>Today's Top Picks</h2>
                </div>
                <div class="col-4">
                    <h3>OMG/USDT</h3>
                </div>
                <div class="col-4">
                    <h3>LOL/USDT</h3>
                </div>
                <div class="col-4">
                    <h3>BRB/USDT</h3>
                </div>
            </div>

        </div>

        <footer class="footer mt-auto container-fluid text-center mt-5">
            <div class="row">
                <div class="col-4 ps-5 text-start">
                    <img class="logo" src="logo.png" alt="logo for Rising Tides" />
                </div>
                <div class="col-4">
                    <span>&copy; Copyright <span id="currentYear">2025</span></span>
                </div>
                <div class="col-4 pe-5 text-end">
                    <a href="#" class="text-decoration-none">
                        <svg width="20" viewbox="0 0 24 24" aria-hidden="true" class="r-4qtqp9 r-yyyyoo r-dnmrzs r-bnwqim r-lrvibr r-m6rgpd r-lrsllp r-1nao33i r-16y2uox r-8kz0gk"><g><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" style="fill:none;stroke:white"></path></g></svg>
                    </a>
                    <span> / </span>
                    <a href="#" class="text-decoration-none">
                        <svg width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="m8 16c4.418278 0 8-3.581722 8-8s-3.581722-8-8-8-8 3.581722-8 8 3.581722 8 8 8zm-1.33048041-6.37283475 3.70945371-3.34749858c.1628067-.14449267-.0355533-.21495334-.25168-.08389334l-4.57819997 2.88833334-1.97753333-.61722c-.42706-.13076-.43012667-.42422.09588-.6352l7.706-2.9714c.3519533-.15978667.6916533.08453333.5572933.62321333l-1.3123333 6.1842c-.09164.43946-.3571667.54456-.72506667.3415667l-1.99909645-1.4769586-.96090355.9343586c-.11163333.1085333-.2.2-.4.2l.13613334-2.03953337z" fill="#fff"></path></svg>
                    </a>
                </div>
            </div>
        </div>

        <script>

            currentYear.textContent = new Date().getFullYear();

            function handleMainControlFormValidation() {
                const ma = parseInt(movingAveragePeriod.value);
                const timeFrame = parseInt(timeframeSelector.value);
                const messageList = [];
                if(!timeFrame || timeFrame > 1000 || !/^\d+$/.test(timeFrame)){
                    messageList.push('Please choose the quantity of candles on which to draw an MA line, 1000 maximum.');
                }
                if(!ma || ma > timeFrame){
                    messageList.push('Please choose the number of samples for a moving average, it must be less than the number of candles.');
                }
                if(messageList.length){
                    mainControlsFormErrorArea.classList.add('d-inline-block');
                    mainControlsFormErrorArea.innerHTML = messageList.join('<br />');
                } else {
                    mainControlsFormErrorArea.classList.remove('d-inline-block');
                    loadingSpinner.classList.remove('d-none');
                    chartsAreaWrap.classList.add('d-none');
                    scrollById(loadingSpinner);
                    runIt().then(r => {
                        loadingSpinner.classList.add('d-none');
                        chartsAreaWrap.classList.remove('d-none');
                        scrollById(chartsAreaWrap);
                    });
                }
            }

            function scrollById(theId) {
                window.scrollTo({
                    top: theId.getBoundingClientRect().y + window.scrollY,
                    left: 0,
                    behavior: "smooth",
                });
            }

            // script loading, if the hidden js folder isn't available this must be live, so load the compiled script
            function scriptExists(src) {
                return new Promise((resolve) => {
                    const script = document.createElement("script");
                    script.src = src;
                    script.onload = () => resolve(true);
                    script.onerror = () => resolve(false);
                    document.head.appendChild(script);
                });
            }
            async function checkScripts() {
                const mainExists = await scriptExists("js/main.js");
                const utilitiesExists = await scriptExists("js/utilities.js");
                const cuckedByAiExists = await scriptExists("js/cucked-by-ai.js");
                if (!mainExists || !utilitiesExists || !cuckedByAiExists) {
                console.warn("Missing required scripts! Loading fallback...");
                document.querySelector('[src="js/main.js"]').remove();
                document.querySelector('[src="js/utilities.js"]').remove();
                document.querySelector('[src="js/cucked-by-ai.js"]').remove();
                const fallbackScript = document.createElement("script");
                fallbackScript.src = "scripts.js";
                document.head.appendChild(fallbackScript);
                }
            }
            checkScripts();
        </script>
    </body>
</html>
